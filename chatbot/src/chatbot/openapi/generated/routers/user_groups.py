# generated by fastapi-codegen:
#   filename:  api.yaml

from __future__ import annotations

from abc import ABC, abstractmethod
from typing import Annotated

from fastapi import APIRouter, Depends
from starlette.requests import Request

from ..dependencies import *


class UsergroupsService(ABC):

    @abstractmethod
    async def generate_assignment_rules(
        self,
        request: Request,
        accept__language: Optional[str] = Header(None, alias='Accept-Language'),
        group_id: UserGroupId = Path(..., alias='groupId'),
        body: GenerateAssignmentRulesRequest = ...,
    ) -> Union[
        GenerateAssignmentRulesSuccessResponse, GenerateAssignmentRulesErrorResponse
    ]: ...


router = APIRouter(tags=['user-groups'])


async def provide_service_impl() -> UsergroupsService:
    from chatbot.openapi.impl.usergroups_service_impl import UsergroupsServiceImpl

    return UsergroupsServiceImpl()


@router.post(
    '/api/admin/users/v4/user-groups/{groupId}/assignment-rules/generate',
    response_model=Union[
        GenerateAssignmentRulesSuccessResponse, GenerateAssignmentRulesErrorResponse
    ],
    tags=['user-groups'],
)
async def generate_assignment_rules(
    request: Request,
    service: Annotated[UsergroupsService, Depends(provide_service_impl)],
    accept__language: Optional[str] = Header(None, alias='Accept-Language'),
    group_id: UserGroupId = Path(..., alias='groupId'),
    body: GenerateAssignmentRulesRequest = ...,
) -> Union[
    GenerateAssignmentRulesSuccessResponse, GenerateAssignmentRulesErrorResponse
]:
    """
    Generate Assignment Rules
    """
    return await service.generate_assignment_rules(
        request, accept__language, group_id, body
    )
