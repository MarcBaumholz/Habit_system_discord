# generated by fastapi-codegen:
#   filename:  api.yaml

from __future__ import annotations

from abc import ABC, abstractmethod
from typing import Annotated

from fastapi import APIRouter, Depends
from starlette.requests import Request

from ..dependencies import *


class AskaiService(ABC):

    @abstractmethod
    async def list_ask_ai_triggers(
        self,
        request: Request,
        page_number: Optional[conint(ge=1)] = 1,
        page_limit: Optional[conint(ge=1, le=25)] = 10,
    ) -> AskAiTriggerSearchResult: ...

    @abstractmethod
    async def create_ask_ai_trigger(
        self, request: Request, body: AskAiTriggerCreateRequest
    ) -> Optional[AskAiTrigger]: ...


router = APIRouter(tags=['ask-ai'])


async def provide_service_impl() -> AskaiService:
    from chatbot.openapi.impl.askai_service_impl import AskaiServiceImpl

    return AskaiServiceImpl()


@router.get(
    '/api/admin/ask-ai/v4/triggers',
    response_model=AskAiTriggerSearchResult,
    tags=['ask-ai'],
)
async def list_ask_ai_triggers(
    request: Request,
    service: Annotated[AskaiService, Depends(provide_service_impl)],
    page_number: Optional[conint(ge=1)] = 1,
    page_limit: Optional[conint(ge=1, le=25)] = 10,
) -> AskAiTriggerSearchResult:
    """
    List Ask AI Triggers
    """
    return await service.list_ask_ai_triggers(request, page_number, page_limit)


@router.post(
    '/api/admin/ask-ai/v4/triggers',
    response_model=None,
    responses={'201': {'model': AskAiTrigger}},
    status_code=201,
    tags=['ask-ai'],
)
async def create_ask_ai_trigger(
    request: Request,
    service: Annotated[AskaiService, Depends(provide_service_impl)],
    body: AskAiTriggerCreateRequest,
) -> Optional[AskAiTrigger]:
    """
    Create Ask AI Trigger
    """
    return await service.create_ask_ai_trigger(request, body)
